<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<style>
:root {
  --bg: #f8fafc;
  --card: #ffffff;
  --accent: #2563eb;
  --accent-light: #e0e7ff;
  --muted: #6b7280;
  --danger: #ef4444;
  --success: #059669;
  --border: #e5e7eb;
  --radius: 14px;
  --shadow: 0 6px 20px rgba(0, 0, 0, 0.06);
}

/* ===== Base ===== */
body {
  font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif;
  background: var(--bg);
  color: #0f172a;
  margin: 0;
  padding: 24px;
}

.container {
  max-width: 1100px;
  margin: 0 auto;
}

/* ===== Header ===== */
header {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 24px;
  gap: 10px;
}

h1 {
  font-size: 1.2rem;
  margin: 0;
  font-weight: 700;
}

.controls button {
  margin-right: 8px;
  padding: 10px 16px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: white;
  cursor: pointer;
  transition: 0.2s;
}
.controls button:hover {
  background: var(--accent-light);
  color: var(--accent);
  border-color: var(--accent);
}

/* ===== Section Cards ===== */
.card {
  background: var(--card);
  border-radius: var(--radius);
  padding: 24px;
  box-shadow: var(--shadow);
  margin-bottom: 24px;
}
.card h2 {
  margin-top: 0;
  font-size: 1.2rem;
  border-left: 5px solid var(--accent);
  padding-left: 10px;
  color: #111827;
}

/* ===== Sentences ===== */
.sentence {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 14px;
  padding: 14px 0;
  border-bottom: 1px dashed #e5eaf0;
}

.text {
  flex: 1;
  min-width: 0;
}
.jp {
  font-size: 1.2rem;
  font-weight: 600;
  color: #111827;
}
.romaji, .sinhala {
  font-size: 0.95rem;
  color: var(--muted);
  margin-top: 4px;
}

/* ===== Actions ===== */
.actions {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-shrink: 0;
  white-space: nowrap;
}
.actions button {
  padding: 8px 12px;
  border-radius: 10px;
  border: 1px solid var(--border);
  background: white;
  cursor: pointer;
  transition: 0.2s;
}
.actions button:hover {
  background: var(--accent-light);
  border-color: var(--accent);
  color: var(--accent);
}
.start-asr {
  background: var(--accent);
  color: white;
  border: none;
}
.start-asr:hover {
  background: #1e40af;
}

/* ===== Mic / ASR ===== */
.mic-status {
  font-size: 0.9rem;
  color: var(--muted);
}
.asr-result {
  display: block;
  margin-top: 4px;
  font-weight: 600;
}
.asr-correct { color: var(--success); }
.asr-wrong { color: var(--danger); }

/* ===== Grid Layout (Numbers / Jobs) ===== */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
  gap: 18px;
}
.list-item.sentence {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  border: 1px solid var(--border);
  border-radius: var(--radius);
  background: #fff;
  box-shadow: 0 3px 10px rgba(0,0,0,0.05);
  padding: 18px;
  transition: 0.2s;
}
.list-item.sentence:hover {
  background: #f9fafb;
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}
.list-item .jp { font-size: 1.3rem; }
.list-item .romaji, .list-item .sinhala {
  display: block;
  font-size: 1rem;
  margin-top: 4px;
}

/* ===== Footer ===== */
footer {
  font-size: 0.9rem;
  color: var(--muted);
  margin-top: 30px;
  text-align: center;
}
/* ===== Adjusted Mobile ‚Äî slightly smaller (use this to reduce 'too big' feeling) ===== */
@media (max-width: 640px) {
  body { padding: 10px; background: #f9fafb; }

  h1 { font-size: 1.25rem; } /* smaller header */

  .card { padding: 16px 12px; border-radius: 12px; margin-bottom: 18px; }
  .card h2 { font-size: 1.2rem; border-left-width: 4px; padding-left: 8px; }

  .sentence,
  .list-item.sentence {
    flex-direction: column;
    align-items: flex-start;
    text-align: left;
    padding: 12px;
    border-radius: 12px;
    margin-bottom: 12px;
    border: 1px solid #e6eef8;
  }

  .jp {
    font-size: 1.25rem;   /* reduce from 1.8rem to 1.25rem */
    font-weight: 700;
    line-height: 1.35;
    margin-bottom: 6px;
  }

  .romaji { font-size: 1rem; }
  .sinhala { font-size: 1rem; margin-top: 6px; }

  .actions {
    margin-top: 8px;
    gap: 10px;
  }

  .actions button {
    padding: 10px;
    font-size: 1.05rem;
    border-radius: 10px;
    width: 48px;
    height: 48px; /* smaller than 56 */
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }

  .grid { display: flex; flex-direction: column; gap: 12px; }

  footer { font-size: 0.95rem; margin-top: 22px; }
}

</style>

</head>
<body>
    <div class="container">
        <header>
            <h1>Iradori Practice ‚Äî All PDF Items (Mic & ASR)</h1>
            <div class="controls">
                <button id="toggleRomaji">Toggle Romaji</button>
                <button id="toggleSinhala">Toggle Sinhala</button>
                <button id="readAll">Read all (TTS)</button>
            </div>
        </header>

        <!-- GREETINGS -->
        <section class="card" id="phrases">
            <h2 style="margin-top:0">Greetings</h2>

            <div class="sentence" data-index="1">
                <div class="text">
                    <div class="jp">„Åä„ÅØ„Çà„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô„ÄÇ</div>
                    <div class="romaji hidden">Ohay≈ç gozaimasu.</div>
                    <div class="sinhala hidden">Subha udƒìsanak (‡∑É‡∑î‡∂∑ ‡∂ã‡∂Ø‡∑ë‡∑É‡∂±‡∂ö‡∑ä)</div>
                    <div class="asr-result" id="result-1"></div>
                </div>
                <div class="actions">
                    <button class="play">‚ñ∂</button>
                    <button class="start-asr">Start</button>
                    <span class="mic-status" id="mic-1"></span>
                </div>
            </div>

            <div class="sentence" data-index="2">
                <div class="text">
                    <div class="jp">„Åì„Çì„Å´„Å°„ÅØ„ÄÇ</div>
                    <div class="romaji hidden">Konnichiwa.</div>
                    <div class="sinhala hidden">Hello (‡∑Ñ‡∑ô‡∂Ω‡∑ù)</div>
                    <div class="asr-result" id="result-2"></div>
                </div>
                <div class="actions"><button class="play">‚ñ∂</button><button class="start-asr">Start</button><span class="mic-status" id="mic-2"></span></div>
            </div>

            <div class="sentence" data-index="3">
                <div class="text">
                    <div class="jp">„Åì„Çì„Å∞„Çì„ÅØ„ÄÇ</div>
                    <div class="romaji hidden">Konban wa.</div>
                    <div class="sinhala hidden">Good evening (‡∑É‡∑î‡∂∑ ‡∑É‡∂±‡∑ä‡∂∞‡∑ä‚Äç‡∂∫‡∑è‡∑Ä‡∂ö‡∑ä)</div>
                    <div class="asr-result" id="result-3"></div>
                </div>
                <div class="actions"><button class="play">‚ñ∂</button><button class="start-asr">Start</button><span class="mic-status" id="mic-3"></span></div>
            </div>

            <div class="sentence" data-index="4">
                <div class="text">
                    <div class="jp">„Åä„ÇÑ„Åô„Åø„Å™„Åï„ÅÑ„ÄÇ</div>
                    <div class="romaji hidden">Oyasuminasai.</div>
                    <div class="sinhala hidden">Subha nidƒÅ (‡∑É‡∑î‡∂∑ ‡∂ª‡∑è‡∂≠‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∂ö‡∑ä)</div>
                    <div class="asr-result" id="result-4"></div>
                </div>
                <div class="actions"><button class="play">‚ñ∂</button><button class="start-asr">Start</button><span class="mic-status" id="mic-4"></span></div>
            </div>
        </section>

        <!-- THANKS / APOLOGY / POLITE PHRASES -->
        <section class="card" id="polite">
            <h2 style="margin-top:0">Polite phrases</h2>

            <div class="sentence" data-index="5">
                <div class="text">
                    <div class="jp">„Å©„ÅÜ„ÇÇ „ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô„ÄÇ</div>
                    <div class="romaji hidden">D≈çmo, arigat≈ç gozaimasu.</div>
                    <div class="sinhala hidden">Bohoma sthuthi (‡∂∂‡∑ú‡∑Ñ‡∑ù‡∂∏ ‡∑É‡∑ä‡∂≠‡∑î‡∂≠‡∑í‡∂∫‡∑í!)</div>
                    <div class="asr-result" id="result-5"></div>
                </div>
                <div class="actions"><button class="play">‚ñ∂</button><button class="start-asr">Start</button><span class="mic-status" id="mic-5"></span></div>
            </div>

            <div class="sentence" data-index="6">
                <div class="text">
                    <div class="jp">„Åô„Åø„Åæ„Åõ„Çì Â§±Á§º„Åó„Åæ„Åô„ÄÇ</div>
                    <div class="romaji hidden">Sumimasen shitsurei shimasu.</div>
                    <div class="sinhala hidden">SamƒÅ wenna, samƒÅvendƒÅ (‡∑É‡∂∏‡∑è‡∑Ä‡∑ô‡∂±‡∑ä‡∂±)</div>
                    <div class="asr-result" id="result-6"></div>
                </div>
                <div class="actions"><button class="play">‚ñ∂</button><button class="start-asr">Start</button><span class="mic-status" id="mic-6"></span></div>
            </div>
        </section>

        <!-- INTRODUCTIONS / DIALOGUE -->
        <section class="card" id="introductions">
            <h2 style="margin-top:0">Introductions & Dialogue</h2>

            <div class="sentence" data-index="10">
                <div class="text">
                    <div class="jp">„Åì„Çì„Å´„Å°„ÅØ </div>
                    <div class="romaji hidden">Konnichiwa ‚Äî Hello</div>
                    <div class="sinhala hidden">‡∑Ñ‡∑ô‡∂Ω‡∑ù</div>
                    <div class="asr-result" id="result-10"></div>
                </div>
                <div class="actions"><button class="play">‚ñ∂</button><button class="start-asr">Start</button><span class="mic-status" id="mic-10"></span></div>
            </div>

            <div class="sentence" data-index="11">
                <div class="text">
                    <div class="jp">ÁßÅ„ÅØ„Çµ„ÉÅ„Éã„Åß„Åô„ÄÇ</div>
                    <div class="romaji hidden">Watashi wa Sachini desu.</div>
                    <div class="sinhala hidden">Mama Sachini (‡∂∏‡∂∏ ‡∑É‡∂†‡∑í‡∂±‡∑í)</div>
                    <div class="asr-result" id="result-11"></div>
                </div>
                <div class="actions"><button class="play">‚ñ∂</button><button class="start-asr">Start</button><span class="mic-status" id="mic-11"></span></div>
            </div>

            <div class="sentence" data-index="12">
                <div class="text">
                    <div class="jp">ÁßÅ„ÅØ„É©„ÉÄ„Éº„Åß„Åô„ÄÇ„Å©„ÅÜ„Åû„Çà„Çç„Åó„Åè„ÅäÈ°ò„ÅÑ„Åó„Åæ„Åô„ÄÇ</div>
                    <div class="romaji hidden">Watashi wa Radha desu. D≈çzo yoroshiku onegaishimasu.</div>
                    <div class="sinhala hidden">Mama Radha. D≈çzo yoroshiku (‡∂∏‡∂∏ ‡∂ª‡∑è‡∂∞‡∑è ‡∑Ä‡∑ô‡∂∏‡∑í)</div>
                    <div class="asr-result" id="result-12"></div>
                </div>
                <div class="actions"><button class="play">‚ñ∂</button><button class="start-asr">Start</button><span class="mic-status" id="mic-12"></span></div>
            </div>

            <div class="sentence" data-index="13">
                <div class="text">
                    <div class="jp">„ÅØ„Åò„ÇÅ„Åæ„Åó„Å¶„ÄÇ„Å©„ÅÜ„Åû„Çà„Çç„Åó„Åè„ÄÇ</div>
                    <div class="romaji hidden">Hajimemashite. D≈çzo yoroshiku.</div>
                    <div class="sinhala hidden">‡∂î‡∂∂‡∑Ä ‡∑Ñ‡∂∏‡∑î‡∑Ä‡∑ì‡∂∏ ‡∑É‡∂≠‡∑î‡∂ß‡∂ö‡∑ä.</div>
                    <div class="asr-result" id="result-13"></div>
                </div>
                <div class="actions"><button class="play">‚ñ∂</button><button class="start-asr">Start</button><span class="mic-status" id="mic-13"></span></div>
            </div>

            <div class="sentence" data-index="14">
                <div class="text">
                    <div class="jp">„ÅäÂêçÂâç„ÅØ‰Ωï„Åß„Åô„ÅãÔºü</div>
                    <div class="romaji hidden">O-namae wa nan desu ka?</div>
                    <div class="sinhala hidden">(‡∂î‡∂∫‡∑è‡∂ú‡∑ö ‡∂±‡∂∏ ‡∂∏‡∑ú‡∂ö‡∂ö‡∑ä‡∂Ø?)</div>
                    <div class="asr-result" id="result-14"></div>
                </div>
                <div class="actions"><button class="play">‚ñ∂</button><button class="start-asr">Start</button><span class="mic-status" id="mic-14"></span></div>
            </div>

            <div class="sentence" data-index="15">
                <div class="text">
                    <div class="jp">ÁßÅ„ÅØ„Çµ„ÇØ„É©„Åß„Åô„ÄÇ</div>
                    <div class="romaji hidden">Watashi wa Sakura desu.</div>
                    <div class="sinhala hidden"> (‡∂∏‡∂∏ ‡∑É‡∂ö‡∑î‡∂ª‡∑è)</div>
                    <div class="asr-result" id="result-15"></div>
                </div>
                <div class="actions"><button class="play">‚ñ∂</button><button class="start-asr">Start</button><span class="mic-status" id="mic-15"></span></div>
            </div>
        </section>

        <!-- COUNTRY / NATIONALITY -->
        <section class="card" id="countries">
            <h2 style="margin-top:0">Country & Nationality</h2>

            <div class="sentence" data-index="20">
                <div class="text">
                    <div class="jp">„ÅäÂõΩ„ÅØ„Å©„Å°„Çâ„Åß„Åô„ÅãÔºü</div>
                    <div class="romaji hidden">Okuni wa dochira desu ka?</div>
                    <div class="sinhala hidden">OyƒÅge rata koheda? (‡∂î‡∂∫‡∑è‡∂ú‡∑ö ‡∂ª‡∂ß ‡∂ö‡∑ú‡∑Ñ‡∑ô‡∂Ø?)</div>
                    <div class="asr-result" id="result-20"></div>
                </div>
                <div class="actions"><button class="play">‚ñ∂</button><button class="start-asr">Start</button><span class="mic-status" id="mic-20"></span></div>
            </div>

            <div class="sentence" data-index="21">
                <div class="text">
                    <div class="jp">„Çπ„É™„É©„É≥„Ç´„Åß„Åô„ÄÇ</div>
                    <div class="romaji hidden">Suriranka desu.</div>
                    <div class="sinhala hidden">Sri Lanka desƒì (‡∑Å‡∑ä‚Äç‡∂ª‡∑ì ‡∂Ω‡∂Ç‡∂ö‡∑è‡∑Ä)</div>
                    <div class="asr-result" id="result-21"></div>
                </div>
                <div class="actions"><button class="play">‚ñ∂</button><button class="start-asr">Start</button><span class="mic-status" id="mic-21"></span></div>
            </div>

            <div class="sentence" data-index="22">
                <div class="text">
                    <div class="jp">„Çπ„É™„É©„É≥„Ç´‰∫∫„Åß„Åô„ÄÇ</div>
                    <div class="romaji hidden">Suriranka-jin desu.</div>
                    <div class="sinhala hidden">Sri LankƒÅ janayak (‡∑Å‡∑ä‚Äç‡∂ª‡∑ì ‡∂Ω‡∂Ç‡∂ö‡∑è ‡∂¢‡∑è‡∂≠‡∑í‡∂ö‡∂∫‡∑ô‡∂ö‡∑ä)</div>
                    <div class="asr-result" id="result-22"></div>
                </div>
                <div class="actions"><button class="play">‚ñ∂</button><button class="start-asr">Start</button><span class="mic-status" id="mic-22"></span></div>
            </div>

            <div class="sentence" data-index="23">
                <div class="text">
                    <div class="jp">ÁßÅ„ÅØÊó•Êú¨„Åã„ÇâÊù•„Åæ„Åó„Åü„ÄÇ</div>
                    <div class="romaji hidden">Watashi wa Nihon kara kimashita.</div>
                    <div class="sinhala hidden">Nihon idan ƒÅyata (‡∂¢‡∂¥‡∂±‡∑ä‡∂ú‡∑ô‡∂±‡∑ä ‡∂Ü‡∑Ä‡∑è)</div>
                    <div class="asr-result" id="result-23"></div>
                </div>
                <div class="actions"><button class="play">‚ñ∂</button><button class="start-asr">Start</button><span class="mic-status" id="mic-23"></span></div>
            </div>
        </section>

        <!-- NUMBERS & AGE PRACTICE -->
        <section class="card" id="numbers">
            <h2 style="margin-top:0">Numbers (S≈´ji) & Ages</h2>

            <!-- number items as sentences -->
            <div class="grid">
                <div class="list-item sentence" data-index="30">
                    <div class="text">
                        <div class="jp">‰∏Ä ‚Äî </div>
                        <div class="romaji hidden">ichi</div>
                        <div class="sinhala hidden">1</div>
                        <div class="asr-result" id="result-30"></div>
                    </div>
                    <div class="actions"><button class="play">‚ñ∂</button><button class="start-asr">Start</button><span class="mic-status" id="mic-30"></span></div>
                </div>

                <div class="list-item sentence" data-index="31">
                    <div class="text">
                        <div class="jp">‰∫å ‚Äî </div>
                        <div class="romaji hidden">ni</div>
                        <div class="sinhala hidden">2</div>
                        <div class="asr-result" id="result-31"></div>
                    </div>
                    <div class="actions"><button class="play">‚ñ∂</button><button class="start-asr">Start</button><span class="mic-status" id="mic-31"></span></div>
                </div>

                <div class="list-item sentence" data-index="32">
                    <div class="text">
                        <div class="jp">‰∏â ‚Äî </div>
                        <div class="romaji hidden">san</div>
                        <div class="sinhala hidden">3</div>
                        <div class="asr-result" id="result-32"></div>
                    </div>
                    <div class="actions"><button class="play">‚ñ∂</button><button class="start-asr">Start</button><span class="mic-status" id="mic-32"></span></div>
                </div>

                <div class="list-item sentence" data-index="33">
                    <div class="text">
                        <div class="jp">Âõõ ‚Äî</div>
                        <div class="romaji hidden">yon / shi</div>
                        <div class="sinhala hidden">4</div>
                        <div class="asr-result" id="result-33"></div>
                    </div>
                    <div class="actions"><button class="play">‚ñ∂</button><button class="start-asr">Start</button><span class="mic-status" id="mic-33"></span></div>
                </div>

           <div class="list-item sentence" data-index="34">
    <div class="text">
        <div class="jp">‰∫î ‚Äî </div>
        <div class="romaji hidden">go</div>
        <div class="sinhala hidden">5</div>
        <div class="asr-result" id="result-34"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-34"></span>
    </div>
</div>

<div class="list-item sentence" data-index="35">
    <div class="text">
        <div class="jp">ÂÖ≠ ‚Äî </div>
        <div class="romaji hidden">roku</div>
        <div class="sinhala hidden">6</div>
        <div class="asr-result" id="result-35"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-35"></span>
    </div>
</div>

<div class="list-item sentence" data-index="36">
    <div class="text">
        <div class="jp">‰∏É ‚Äî </div>
        <div class="romaji hidden">nana</div>
        <div class="sinhala hidden">7</div>
        <div class="asr-result" id="result-36"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-36"></span>
    </div>
</div>

<div class="list-item sentence" data-index="37">
    <div class="text">
        <div class="jp">ÂÖ´ ‚Äî </div>
        <div class="romaji hidden">hachi</div>
        <div class="sinhala hidden">8</div>
        <div class="asr-result" id="result-37"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-37"></span>
    </div>
</div>

<div class="list-item sentence" data-index="38">
    <div class="text">
        <div class="jp">‰πù ‚Äî </div>
        <div class="romaji hidden">ky≈´</div>
        <div class="sinhala hidden">9</div>
        <div class="asr-result" id="result-38"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-38"></span>
    </div>
</div>

<div class="list-item sentence" data-index="39">
    <div class="text">
        <div class="jp">ÂçÅ ‚Äî </div>
        <div class="romaji hidden">j≈´</div>
        <div class="sinhala hidden">10</div>
        <div class="asr-result" id="result-39"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-39"></span>
    </div>
</div>

<div class="list-item sentence" data-index="40">
    <div class="text">
        <div class="jp">‰∫åÂçÅ ‚Äî </div>
        <div class="romaji hidden">ni j≈´</div>
        <div class="sinhala hidden">20</div>
        <div class="asr-result" id="result-40"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-40"></span>
    </div>
</div>

<div class="list-item sentence" data-index="41">
    <div class="text">
        <div class="jp">‰∏âÂçÅ ‚Äî </div>
        <div class="romaji hidden">san j≈´</div>
        <div class="sinhala hidden">30</div>
        <div class="asr-result" id="result-41"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-41"></span>
    </div>
</div>

<div class="list-item sentence" data-index="42">
    <div class="text">
        <div class="jp">ÂõõÂçÅ ‚Äî </div>
        <div class="romaji hidden">yon j≈´</div>
        <div class="sinhala hidden">40</div>
        <div class="asr-result" id="result-42"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-42"></span>
    </div>
</div>

<div class="list-item sentence" data-index="43">
    <div class="text">
        <div class="jp">‰∫îÂçÅ ‚Äî </div>
        <div class="romaji hidden">go j≈´</div>
        <div class="sinhala hidden">50</div>
        <div class="asr-result" id="result-43"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-43"></span>
    </div>
</div>

<div class="list-item sentence" data-index="44">
    <div class="text">
        <div class="jp">ÂÖ≠ÂçÅ ‚Äî </div>
        <div class="romaji hidden">roku j≈´</div>
        <div class="sinhala hidden">60</div>
        <div class="asr-result" id="result-44"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-44"></span>
    </div>
</div>

<div class="list-item sentence" data-index="45">
    <div class="text">
        <div class="jp">‰∏ÉÂçÅ ‚Äî </div>
        <div class="romaji hidden">nana j≈´</div>
        <div class="sinhala hidden">70</div>
        <div class="asr-result" id="result-45"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-45"></span>
    </div>
</div>

<div class="list-item sentence" data-index="46">
    <div class="text">
        <div class="jp">ÂÖ´ÂçÅ ‚Äî </div>
        <div class="romaji hidden">hachi j≈´</div>
        <div class="sinhala hidden">80</div>
        <div class="asr-result" id="result-46"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-46"></span>
    </div>
</div>

<div class="list-item sentence" data-index="47">
    <div class="text">
        <div class="jp">‰πùÂçÅ ‚Äî </div>
        <div class="romaji hidden">ky≈´ j≈´</div>
        <div class="sinhala hidden">90</div>
        <div class="asr-result" id="result-47"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-47"></span>
    </div>
</div>

<div class="list-item sentence" data-index="48">
    <div class="text">
        <div class="jp">Áôæ ‚Äî </div>
        <div class="romaji hidden">hyaku</div>
        <div class="sinhala hidden">100</div>
        <div class="asr-result" id="result-48"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-48"></span>
    </div>
</div>







            <!-- age example sentences -->
    <div class="list-item sentence" data-index="49">
    <div class="text">
        <div class="jp">‰∏ÄÊ≠≥ ‚Äî </div>
        <div class="romaji hidden">issai</div>
        <div class="sinhala hidden">1 year old</div>
        <div class="asr-result" id="result-49"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-49"></span>
    </div>
</div>

<div class="list-item sentence" data-index="50">
    <div class="text">
        <div class="jp">ÂçÅ‰∏ÄÊ≠≥ ‚Äî </div>
        <div class="romaji hidden">j≈´ issai</div>
        <div class="sinhala hidden">11 years old</div>
        <div class="asr-result" id="result-50"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-50"></span>
    </div>
</div>

<div class="list-item sentence" data-index="51">
    <div class="text">
        <div class="jp">‰∫åÂçÅ‰∏ÄÊ≠≥ ‚Äî </div>
        <div class="romaji hidden">ni j≈´ issai</div>
        <div class="sinhala hidden">21 years old</div>
        <div class="asr-result" id="result-51"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-51"></span>
    </div>
</div>

<div class="list-item sentence" data-index="52">
    <div class="text">
        <div class="jp">‰∏âÂçÅ‰∏ÄÊ≠≥ ‚Äî </div>
        <div class="romaji hidden">san j≈´ issai</div>
        <div class="sinhala hidden">31 years old</div>
        <div class="asr-result" id="result-52"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-52"></span>
    </div>
</div>

<div class="list-item sentence" data-index="53">
    <div class="text">
        <div class="jp">ÂõõÂçÅ‰∏ÄÊ≠≥ ‚Äî </div>
        <div class="romaji hidden">yon j≈´ issai</div>
        <div class="sinhala hidden">41 years old</div>
        <div class="asr-result" id="result-53"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-53"></span>
    </div>
</div>

<div class="list-item sentence" data-index="54">
    <div class="text">
        <div class="jp">ÂÖ´Ê≠≥ ‚Äî </div>
        <div class="romaji hidden">hassai</div>
        <div class="sinhala hidden">8 years old</div>
        <div class="asr-result" id="result-54"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-54"></span>
    </div>
</div>

<div class="list-item sentence" data-index="55">
    <div class="text">
        <div class="jp">ÂçÅÂÖ´Ê≠≥ ‚Äî </div>
        <div class="romaji hidden">j≈´ hassai</div>
        <div class="sinhala hidden">18 years old</div>
        <div class="asr-result" id="result-55"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-55"></span>
    </div>
</div>

<div class="list-item sentence" data-index="56">
    <div class="text">
        <div class="jp">‰∫åÂçÅÂÖ´Ê≠≥ ‚Äî </div>
        <div class="romaji hidden">ni j≈´ hassai</div>
        <div class="sinhala hidden">28 years old</div>
        <div class="asr-result" id="result-56"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-56"></span>
    </div>
</div>

<div class="list-item sentence" data-index="57">
    <div class="text">
        <div class="jp">‰∏âÂçÅÂÖ´Ê≠≥ ‚Äî </div>
        <div class="romaji hidden">san j≈´ hassai</div>
        <div class="sinhala hidden">38 years old</div>
        <div class="asr-result" id="result-57"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-57"></span>
    </div>
</div>

<div class="list-item sentence" data-index="58">
    <div class="text">
        <div class="jp">ÂçÅÊ≠≥ ‚Äî </div>
        <div class="romaji hidden">jussai</div>
        <div class="sinhala hidden">10 years old</div>
        <div class="asr-result" id="result-58"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-58"></span>
    </div>
</div>

<div class="list-item sentence" data-index="59">
    <div class="text">
        <div class="jp">‰∫åÂçÅÊ≠≥ ‚Äî </div>
        <div class="romaji hidden">ni jussai</div>
        <div class="sinhala hidden">20 years old</div>
        <div class="asr-result" id="result-59"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-59"></span>
    </div>
</div>

<div class="list-item sentence" data-index="60">
    <div class="text">
        <div class="jp">‰∏âÂçÅÊ≠≥ ‚Äî </div>
        <div class="romaji hidden">san jussai</div>
        <div class="sinhala hidden">30 years old</div>
        <div class="asr-result" id="result-60"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-60"></span>
    </div>
</div>

<div class="list-item sentence" data-index="61">
    <div class="text">
        <div class="jp">ÂõõÂçÅÊ≠≥ ‚Äî </div>
        <div class="romaji hidden">yon jussai</div>
        <div class="sinhala hidden">40 years old</div>
        <div class="asr-result" id="result-61"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-61"></span>
    </div>
</div>

<div class="list-item sentence" data-index="62">
    <div class="text">
        <div class="jp">‰∫îÂçÅÊ≠≥ ‚Äî </div>
        <div class="romaji hidden">go jussai</div>
        <div class="sinhala hidden">50 years old</div>
        <div class="asr-result" id="result-62"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-62"></span>
    </div>
</div>
<!-- üó£Ô∏è Conversation: Asking Age („Å™„Çì„Åï„ÅÑ„Åß„Åô„Åã) -->

<div class="list-item sentence" data-index="63">
    <div class="text">
        <div class="jp">A: ‚Ä¶‚Ä¶„Åï„Çì„ÄÅ„Å™„Çì„Åï„ÅÑ„Åß„Åô„Åã„ÄÇ</div>
        <div class="romaji hidden">A: ... San, nan sai desu ka.</div>
        <div class="sinhala hidden">A: ‡∂î‡∂∫‡∑è‡∂ß ‡∑Ä‡∂∫‡∑É ‡∂ö‡∑ì‡∂∫‡∂Ø?</div>
        <div class="asr-result" id="result-63"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-63"></span>
    </div>
</div>

<div class="list-item sentence" data-index="64">
    <div class="text">
        <div class="jp">B: „Çè„Åü„Åó„ÅØ ÔºíÔºî„Åï„ÅÑ „Åß„Åô„ÄÇ„ÅÇ„Å™„Åü„ÅØÔºü</div>
        <div class="romaji hidden">B: Watashi wa nij≈´yon sai desu. Anata wa?</div>
        <div class="sinhala hidden">B: ‡∂∏‡∂ß ‡∑Ä‡∂∫‡∑É 24‡∂∫‡∑í. ‡∂î‡∂∫‡∑è‡∂ß?</div>
        <div class="asr-result" id="result-64"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-64"></span>
    </div>
</div>

<div class="list-item sentence" data-index="65">
    <div class="text">
        <div class="jp">A: „Çè„Åü„Åó„ÅØ ÔºíÔºë„Åï„ÅÑ „Åß„Åô„ÄÇ</div>
        <div class="romaji hidden">A: Watashi wa nij≈´ichi sai desu.</div>
        <div class="sinhala hidden">A: ‡∂∏‡∂ß ‡∑Ä‡∂∫‡∑É 21‡∂∫‡∑í.</div>
        <div class="asr-result" id="result-65"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-65"></span>
    </div>
</div>

<div class="list-item sentence" data-index="66">
    <div class="text">
        <div class="jp">B: „Åã„ÅÆ„Åò„Çá„ÅØ „Å™„Çì„Åï„ÅÑ „Åß„Åô„Åã„ÄÇ</div>
        <div class="romaji hidden">B: Kanojo wa nan sai desu ka.</div>
        <div class="sinhala hidden">B: ‡∂á‡∂∫‡∂ú‡∑ö ‡∑Ä‡∂∫‡∑É ‡∂ö‡∑ì‡∂∫‡∂Ø?</div>
        <div class="asr-result" id="result-66"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-66"></span>
    </div>
</div>

<div class="list-item sentence" data-index="67">
    <div class="text">
        <div class="jp">A: „Åã„ÅÆ„Åò„Çá„ÅØ ÔºëÔºò„Åï„ÅÑ „Åß„Åô„ÄÇ</div>
        <div class="romaji hidden">A: Kanojo wa j≈´hassai desu.</div>
        <div class="sinhala hidden">A: ‡∂á‡∂∫‡∂ú‡∑ö ‡∑Ä‡∂∫‡∑É 18‡∂∫‡∑í.</div>
        <div class="asr-result" id="result-67"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-67"></span>
    </div>
</div>

 </section>


 
        <!-- OCCUPATIONS ‚Äî every item becomes interactive -->
        <section class="card" id="jobs">
            <h2 style="margin-top:0">Occupations (Vocabulary) ‚Äî each item has mic & TTS</h2>
            <p class="small">From PDF: each occupation below can be practiced with TTS and ASR.</p>
            <div class="grid">
                <!-- üßë‚Äçüíº ËÅ∑Ê•≠ÔºàShokugy≈çÔºâ‚Äì Occupations -->

<div class="list-item sentence" data-index="68">
    <div class="text">
        <div class="jp">„Åã„ÅÑ„Åó„ÇÉ„ÅÑ„Çì ‚Äî </div>
        <div class="romaji hidden">kaishain</div>
        <div class="sinhala hidden">company employee</div>
        <div class="asr-result" id="result-68"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-68"></span>
    </div>
</div>

<div class="list-item sentence" data-index="69">
    <div class="text">
        <div class="jp">„Åé„Çì„Åì„ÅÜ„ÅÑ„Çì ‚Äî </div>
        <div class="romaji hidden">gink≈çin</div>
        <div class="sinhala hidden">bank employee</div>
        <div class="asr-result" id="result-69"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-69"></span>
    </div>
</div>

<div class="list-item sentence" data-index="70">
    <div class="text">
        <div class="jp">„Åç„Çá„ÅÜ„Åó ‚Äî </div>
        <div class="romaji hidden">ky≈çshi</div>
        <div class="sinhala hidden">teacher</div>
        <div class="asr-result" id="result-70"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-70"></span>
    </div>
</div>

<div class="list-item sentence" data-index="71">
    <div class="text">
        <div class="jp">„Å¶„Çì„ÅÑ„Çì ‚Äî </div>
        <div class="romaji hidden">ten'in</div>
        <div class="sinhala hidden">shop assistant</div>
        <div class="asr-result" id="result-71"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-71"></span>
    </div>
</div>

<div class="list-item sentence" data-index="72">
    <div class="text">
        <div class="jp">„Åì„ÅÜ„ÇÄ„ÅÑ„Çì ‚Äî </div>
        <div class="romaji hidden">k≈çmuin</div>
        <div class="sinhala hidden">civil servant</div>
        <div class="asr-result" id="result-72"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-72"></span>
    </div>
</div>

<div class="list-item sentence" data-index="73">
    <div class="text">
        <div class="jp">„Åπ„Çì„Åî„Åó ‚Äî </div>
        <div class="romaji hidden">bengoshi</div>
        <div class="sinhala hidden">lawyer</div>
        <div class="asr-result" id="result-73"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-73"></span>
    </div>
</div>

<div class="list-item sentence" data-index="74">
    <div class="text">
        <div class="jp">„Å°„Çá„ÅÜ„Çä„Åó ‚Äî </div>
        <div class="romaji hidden">ch≈çrishi</div>
        <div class="sinhala hidden">cook / chef</div>
        <div class="asr-result" id="result-74"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-74"></span>
    </div>
</div>

<div class="list-item sentence" data-index="75">
    <div class="text">
        <div class="jp">„ÅÜ„Çì„Å¶„Çì„Åó„ÇÖ ‚Äî </div>
        <div class="romaji hidden">untenshu</div>
        <div class="sinhala hidden">driver</div>
        <div class="asr-result" id="result-75"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-75"></span>
    </div>
</div>

<div class="list-item sentence" data-index="76">
    <div class="text">
        <div class="jp">„Åã„Åó„ÇÖ ‚Äî </div>
        <div class="romaji hidden">kashu</div>
        <div class="sinhala hidden">singer</div>
        <div class="asr-result" id="result-76"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-76"></span>
    </div>
</div>

<div class="list-item sentence" data-index="77">
    <div class="text">
        <div class="jp">„Åå„Åã ‚Äî </div>
        <div class="romaji hidden">gaka</div>
        <div class="sinhala hidden">painter</div>
        <div class="asr-result" id="result-77"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-77"></span>
    </div>
</div>

<div class="list-item sentence" data-index="78">
    <div class="text">
        <div class="jp">„Ç®„É≥„Ç∏„Éã„Ç¢ ‚Äî </div>
        <div class="romaji hidden">enjinia</div>
        <div class="sinhala hidden">engineer</div>
        <div class="asr-result" id="result-78"></div>
    </div>
    <div class="actions">
        <button class="play">‚ñ∂</button>
        <button class="start-asr">Start</button>
        <span class="mic-status" id="mic-78"></span>
    </div>
</div>
 </div>
 </section>

        <!-- QUICK EXERCISE -->
        <section class="card exercise" id="exercise">
            <h2 style="margin-top:0">Quick Exercise ‚Äî Choose correct greeting</h2>
            <p class="small">Situation: Êúù„Å´Âèã„Å†„Å°„Å´‰ºö„Å£„Åü„Å®„Åç„ÄÅ„Å©„ÅÆÊå®Êã∂„ÇíÈÄÅ„Çä„Åæ„Åô„ÅãÔºü</p>
            <div id="choices">
                <div class="choice" data-value="a">„Åä„ÅØ„Çà„ÅÜ</div>
                <div class="choice" data-value="b">„Åì„Çì„Å´„Å°„ÅØ</div>
                <div class="choice" data-value="c">„Åì„Çì„Å∞„Çì„ÅØ</div>
                <div class="choice" data-value="d">„Åä„ÇÑ„Åô„Åø</div>
            </div>
            <div style="margin-top:10px">
                <button id="checkAnswer">Check answer</button>
                <span id="answerText" class="small" style="margin-left:10px"></span>
            </div>
        </section>

        <footer>
            Tip: Click "Start" to begin speech recognition for that phrase. The browser will ask permission to use the microphone.
            Chrome/Edge on desktop have the most complete SpeechRecognition support. Source: PDF you uploaded. 
        </footer>
    </div>

    <script>
        // Toggle display helpers
        function toggleClassAll(selector, cls) {
            document.querySelectorAll(selector).forEach(el => el.classList.toggle(cls));
        }
        document.getElementById('toggleRomaji').addEventListener('click', function () { toggleClassAll('.romaji', 'hidden'); });
        document.getElementById('toggleSinhala').addEventListener('click', function () { toggleClassAll('.sinhala', 'hidden'); });

        // Text-to-speech (Japanese)
        function speak(text) {
            if (!('speechSynthesis' in window)) { alert('SpeechSynthesis not supported in this browser.'); return; }
            var ut = new SpeechSynthesisUtterance(text);
            ut.lang = 'ja-JP';
            var voices = speechSynthesis.getVoices();
            for (var i = 0; i < voices.length; i++) {
                if (voices[i].lang.indexOf('ja') === 0) { ut.voice = voices[i]; break; }
            }
            window.speechSynthesis.cancel();
            window.speechSynthesis.speak(ut);
        }

        // Wire up play buttons (works for every .sentence)
        document.querySelectorAll('.sentence').forEach(function (node) {
            var playBtn = node.querySelector('.play');
            if (!playBtn) return;
            playBtn.addEventListener('click', function () {
                var jp = node.querySelector('.jp').textContent.trim();
                speak(jp);
            });
        });

        // Read all sentences (collect .jp elements)
        document.getElementById('readAll').addEventListener('click', function () {
            var texts = Array.from(document.querySelectorAll('.sentence .jp')).map(n => n.textContent.trim()).join(' ');
            speak(texts);
        });

        // Exercise choice selection
        document.querySelectorAll('#choices .choice').forEach(function (choice) {
            choice.addEventListener('click', function () {
                document.querySelectorAll('#choices .choice').forEach(c => c.classList.remove('selected'));
                choice.classList.add('selected');
                document.getElementById('answerText').textContent = '';
            });
        });
        document.getElementById('checkAnswer').addEventListener('click', function () {
            var sel = document.querySelector('#choices .choice.selected');
            var out = document.getElementById('answerText');
            if (!sel) { out.textContent = 'Please select a choice.'; return; }
            if (sel.dataset.value === 'a') {
                out.textContent = 'Correct ‚Äî „Åä„ÅØ„Çà„ÅÜ (Morning greeting).';
            } else {
                out.textContent = 'Not correct. The best choice is „Åä„ÅØ„Çà„ÅÜ for morning.';
            }
        });

        // --- Speech Recognition (ASR) setup ---
        var SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition || null;

        function normalizeForCompare(s) {
            // lower-case, strip spaces/punctuation and common long-vowel char ‚Äî simple normalization
            if (!s) return '';
            return s.toLowerCase().replace(/[\u3000\s\.,!?\-\"'¬´¬ª\(\)\[\]_]/g, '').replace(/„Éº/g, '').replace(/„ÄÇ/g, '').trim();
        }

        // Add ASR handlers to every .sentence that has .start-asr
        document.querySelectorAll('.sentence').forEach(function (node) {
            var startBtn = node.querySelector('.start-asr');
            var resEl = node.querySelector('.asr-result');
            var micEl = node.querySelector('.mic-status');
            var targetEl = node.querySelector('.jp');
            if (!startBtn || !resEl || !micEl || !targetEl) return;
            var target = targetEl.textContent.trim();

            startBtn.addEventListener('click', function () {
                resEl.textContent = '';
                micEl.textContent = '';

                if (!SpeechRecognition) {
                    // fallback: request microphone permission so user sees flow, but no ASR
                    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                        navigator.mediaDevices.getUserMedia({ audio: true }).then(function (stream) {
                            micEl.textContent = 'Microphone access granted (no ASR). Use Chrome/Edge for recognition.';
                            stream.getTracks().forEach(t => t.stop());
                        }).catch(function (err) { micEl.textContent = 'Microphone permission denied.'; });
                    } else {
                        micEl.textContent = 'SpeechRecognition not supported in this browser.';
                    }
                    return;
                }

                // create recognition instance per start (simple flow)
                var recog = new SpeechRecognition();
                recog.lang = 'ja-JP';
                recog.interimResults = false;
                recog.maxAlternatives = 3;

                recog.onstart = function () { micEl.textContent = 'Listening...'; };
                recog.onerror = function (e) { micEl.textContent = 'Error: ' + (e.error || e.message || 'unknown'); };
                recog.onend = function () { if (micEl.textContent === 'Listening...') micEl.textContent = 'Stopped.'; };

                recog.onresult = function (ev) {
                    var transcript = '';
                    for (var i = 0; i < ev.results.length; i++) {
                        transcript += ev.results[i][0].transcript + ' ';
                    }
                    transcript = transcript.trim();

                    // show recognized text
                    resEl.innerHTML = 'Recognized: <span class="small">' + transcript + '</span>';

                    // compare normalized strings (very simple compare)
                    var normRec = normalizeForCompare(transcript);
                    var normTarget = normalizeForCompare(target);

                    if (!normRec) {
                        resEl.innerHTML += ' <span class="asr-wrong">‚úñ No speech recognized</span>';
                        speak(target); // hint
                        return;
                    }

                    // match heuristics: exact, substring, or reversed substring
                    if (normRec === normTarget || normTarget.indexOf(normRec) !== -1 || normRec.indexOf(normTarget) !== -1) {
                        resEl.innerHTML += ' <span class="asr-correct">‚úî Good match</span>';
                        speak('„Çà„Åè„Åß„Åç„Åæ„Åó„Åü„ÄÇ');
                    } else {
                        resEl.innerHTML += ' <span class="asr-wrong">‚úñ Not exact</span>';
                        // play the correct phrase as hint
                        speak(target);
                    }
                };

                try { recog.start(); } catch (err) { micEl.textContent = 'Recognition start failed: ' + err.message; }
            });
        });

        // Ensure voices loaded for some browsers
        if (speechSynthesis && speechSynthesis.getVoices().length === 0) {
            speechSynthesis.addEventListener('voiceschanged', function () {});
        }
    </script>